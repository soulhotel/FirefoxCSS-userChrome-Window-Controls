@namespace xul url("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul");

/* Index [ctrl+f to find a section]

baseline modifications (configure nav bar color here if needed)
to return the title bar buttons
adjust nav bar margin
total button size
(optional) flip button order
when in fullscreen mode
macos layout
linux kde layout
linux gnome layout (compatible with cinnamon)

/*-------------------------------------------------------------------------------------*/

/* baseline modifications (configure nav bar color here if needed) */

#navigator-toolbox {
  background: var(--toolbar-bgcolor) !important;
  /*background: var(--your-own-variable) !important;*/
  /*background: rgb(1,1,1) !important;*/
}

#TabsToolbar { display: none !important; }

#titlebar { display: initial !important; }

#titlebar {
    order: 2;
    -moz-appearance: none !important;
    --tabs-navbar-shadow-size: 0px;
}

#navigator-toolbox > div{ display: contents }

.global-notificationbox, #tab-notification-deck{order: 2;}

#TabsToolbar .titlebar-spacer{ display: none; }

#navigator-toolbox::after{ display: none !important; }

toolbox#navigator-toolbox > toolbar#nav-bar.browser-toolbar{ animation: none; }

#navigator-toolbox:hover #TabsToolbar{ animation: slidein ease-out 48ms 1; }

#navigator-toolbox:not(:-moz-lwtheme){ background-color: -moz-dialog; }


/*--------------------------------------------------------------------------------------*/

/* to return the title bar buttons */

:root[tabsintitlebar] .titlebar-buttonbox{
    position: fixed !important;
    display: flex !important;
    z-index: 2 !important;
    top: 4.2px !important;
    right: 2px !important; /* or use 'left' to simulate macos positioning */
}

/* to simulate toolbar buttons size and positioning, while keeping the window controls to the far end of the bar */

/* adjust nav bar margin */
#nav-bar {
    margin-right: 98px; /* margin-left if you have it on left side*/
} 

/* 30px total button size to match toolbar buttons. */
@media (-moz-platform: windows) {
    .titlebar-buttonbox .titlebar-button {
        padding: 11px 11px !important;
        border-radius: 5px !important;
    }
}

/* (optional) flip button order
.titlebar-buttonbox-container{ direction: rtl; } */

/* when in fullscreen mode, and the navigation bar isnt hovered, workaround for fixed title bar buttons */

:root[inFullscreen="true"] #navigator-toolbox:not(:hover) .titlebar-buttonbox {
    display: none !important;
}


/*--------------------------------------------------------------------------------------*/

/* macos layout */

@media (-moz-os-version: macos), (-moz-platform: macos) {
    #nav-bar {
        margin-left: 84px !important;
        margin-right: 0px !important;
    }    

    :root[tabsintitlebar] .titlebar-buttonbox {
        top: 12px !important;
        right: unset !important;
        left: 3px !important;
    }
    toolbar {
        min-height: 0px !important;
    }
}


/*--------------------------------------------------------------------------------------*/

/* linux button corrections */

@media (-moz-platform: linux), (-moz-os-version: linux) {

    /* update nav bar spacing */
    #nav-bar {margin-right: 86px !important;}
    
    /* override inactive window style */
    :root:where([tabsintitlebar]) {
        --toolbox-non-lwt-textcolor: var(--uc-text);
        --toolbox-non-lwt-textcolor-inactive: var(--uc-text);
    } :root {
        --inactive-titlebar-opacity: 1 !important;
    }

    /* remove secondary background, and correct stroke */
    #main-window:not([lwtheme]) .titlebar-button {
        stroke: initial !important;
    } #main-window[lwtheme] .titlebar-button {
        stroke: var(--toolbarbutton-icon-fill) !important;
    }
    #main-window:not([lwtheme]) .titlebar-button:hover {
        fill: initial !important;
    } #main-window[lwtheme] .titlebar-button:hover {
        fill: black !important;
    }
    
}

/*------------------------------------------------------------------------*/

/* linux kde layout */

@media (-moz-bool-pref: "OS.kde") {
@media (-moz-platform: linux), (-moz-os-version: linux) {

    :root[tabsintitlebar] {
        .titlebar-buttonbox {
            top: 7px !important;
            right: 5px !important;
        }
        &[uidensity="compact"] .titlebar-buttonbox {
            top: 4px !important;
        }
    }
    
    .titlebar-button, .titlebar-button[lwtheme] {
        appearance: none !important;
        margin: 0 !important;
        margin-top: 0px !important;
        padding: 4px 4px !important;
        justify-content: center !important;
        color: inherit !important;
        -moz-context-properties: fill, fill-opacity !important;
        fill: var(--toolbarbutton-icon-fill) !important;
        stroke: var(--toolbarbutton-icon-fill) !important;
        border-radius: 5px !important;
    }
    
    .titlebar-button .toolbarbutton-icon,
    .titlebar-button[lwtheme] .toolbarbutton-icon,
    .titlebar-button[lwtheme] .toolbarbutton-icon[lwtheme] {
        border-radius: var(--toolbarbutton-border-radius) !important;
        list-style-image: url("chrome://global/skin/icons/arrow-down.svg");
        opacity: 1 !important;
        padding: 3px !important;
    }

    /* icons override, default icons dont override when there is window inactivity */
    .titlebar-button.titlebar-close .toolbarbutton-icon{
        list-style-image: url("icons/lin-close.svg") !important;
        margin-top: -1px !important;
    }
    .titlebar-button.titlebar-min .toolbarbutton-icon{
        list-style-image: url("icons/lin-min.svg") !important;
        margin-top: -1px !important;
    }
    .titlebar-button.titlebar-max .toolbarbutton-icon{
        list-style-image: url("icons/lin-max.svg") !important;
        margin-top: -1px !important;
    }
    .titlebar-button.titlebar-restore .toolbarbutton-icon{
        list-style-image: url("icons/lin-restore.svg") !important;
        margin-top: -1px !important;
    }

    /* override background changes when hovered */
    #main-window .titlebar-button:hover,    
    #main-window:not([lwtheme]) .titlebar-button:hover {
        background-color: transparent !important;
        border-radius: 5px;
    } .titlebar-close:hover {
        background-color: rgb(191, 66, 66) !important;
    }
    
    /*--override padding--*/
    .titlebar-button > .toolbarbutton-icon[lwtheme] {
        padding: 4px 4px !important;
        -moz-context-properties: revert !important;
        stroke: currentColor;
        border-radius: 5px;
    }
}
} 

/*------------------------------------------------------------------------*/
/* Gnome window controls */

@media (-moz-bool-pref: "OS.gnome") {
@media (-moz-platform: linux), (-moz-os-version: linux) {

    #nav-bar {margin-right: 100px !important;}
    
    :root[tabsintitlebar] .titlebar-buttonbox {
        top: 8px !important;
        right: 5px !important;
    }
    :root .titlebar-button:hover {
        background: transparent !important;
        background-color: transparent !important;
    }
}
}
